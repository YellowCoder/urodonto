<% page_title 'VisÃ£o geral de pagamentos' %>

<div class="overview__wrapper">
  <%= simple_form_for @overview_date, method: :get do |f| %>
    <%= f.input :initial_date, as: :date, order: [:month, :year] %>
    <%= f.input :end_date, as: :date, order: [:month, :year] %>
    <%= f.submit 'Filtrar' %>
  <% end %>

  <div class="overview__tablesWrapper">
    <div class="overview__patientsList">
      <table id="overview__patientsList">
        <thead>
          <tr>
            <th>Paciente</th>
          </tr>
        </thead>

        <tbody>
          <% @overview.each_with_index do |patient, index|%>
            <tr class=<%= index % 2 == 0 ? 'even' : 'odd' %>>
              <td><%= patient[:name] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <div class="overview__appointmentsList">
      <table style="table-layout:fixed;" id="overview__appointmentsList">
        <thead>
          <tr>
            <% @date_range.each do |date|%>
              <th><%= date[:label] %></th>
            <% end %>
          </tr>
        </thead>

        <tbody>
          <% @overview.each_with_index do |patient, index|%>
            <tr class=<%= index % 2 == 0 ? 'even' : 'odd' %>>
              <% @date_range.each do |date|%>
                <td>
                  <div class="overview__appointmentItems">
                    <% patient.foo(date).each do |appointment| %>
                      <div class=<%= appointment[:color]? "overview__appointment--#{ appointment[:color]}" : "overview__appointmentItem" %>>
                        <% if appointment[:appointment] %>
                          <%= link_to appointment[:label], appointment_path(appointment[:appointment]), target: "_blank" if appointment[:appointment]%>
                        <% else %>
                          <span>
                            <%= appointment[:label] %>
                          </span>
                        <% end %>
                      </div>
                    <% end %>
                  </div>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>